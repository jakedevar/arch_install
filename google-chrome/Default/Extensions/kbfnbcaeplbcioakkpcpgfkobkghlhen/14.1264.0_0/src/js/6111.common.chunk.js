(self.webpackChunk=self.webpackChunk||[]).push([[6111],{16111:(e,t,r)=>{r.r(t),r.d(t,{BugReportForm:()=>w});var a=r(92379),o=r(53768),n=r(50635),l=r(31702),s=r(83542),i=r(52348),c=r(69554),u=r(405),g=r(39397),d=r(21553),p=r(15380),m=r(44675),h=r(20905),b=r(40594),f=r(56623),x=r(67960),y=r(29483);const k=b.Y.create("BugReportUtils");async function v(){try{if(!(0,y.OB)().historyLogsService.isHistoryEnabled())return k.debug("debug reports feature is not enabled"),null;const e=[],t=[new f.r("bg",(()=>(0,y.OB)().bgRpc.api.getBGLogs()),f.r.getLogsFromSessionStorageFallbackGetter(x.v.bgHistoryLogs)),new f.r("popup",(()=>Promise.resolve((0,y.OB)().historyLogsService.getLogs())),f.r.getLogsFromSessionStorageFallbackGetter(x.v.popupHistoryLogs)),new f.r("cs",(async()=>{const e=[],t=t=>{e.push(...t.option.logs.map((e=>({...e,loggerName:`${t.option.isIframeIntegration?`iframe.[${t.caller.frameId}].`:""}${e.loggerName}`}))))};return(0,y.OB)().bgRpc.api.sendToFocusTab({kind:p.B.Kind.sendCsLogsToPopup}),(0,y.OB)().message.on(p.I.Kind.sendCsLogs,t),await(0,m.gw)(h.E0),e.length||await(0,m.gw)(h.E0),(0,y.OB)().message.off(p.I.Kind.sendCsLogs,t),e.length?e:void 0}),f.r.getLogsFromSessionStorageFallbackGetter(x.v.csHistoryLogs))];try{await(0,m.Fb)(h.E0,async function(){k.info("latest experiments state",await(0,y.OB)().bgRpc.api.getExperimentTreatment()),k.info("latest storage state",await(0,y.OB)().browserApi.preferences.getAll()),k.info("browser info",(0,y.OB)().browserApi.getBrowserInfo())}())}catch(e){k.warn("cannot get latest app state",e)}t.sort((e=>e.envName===(0,y.OB)().context?1:-1));for(const r of t){const t=await r.getLogs();e.push(...null!=t?t:[])}e.sort(((e,t)=>e.timestamp-t.timestamp));const r=function(e){const t=e=>{try{return JSON.stringify(e)}catch(t){return String(e)}};return[["Level","Logger","Timestamp","Message"].join("\t"),...e.map((e=>{const r=[e.level,e.loggerName,new Date(e.timestamp).toISOString(),e.message];return e.data&&r.push(t(e.data)),e.exception&&r.push(t(e.exception)),r.join("\t")}))].join("\n")}(e),a=`grammarly-logs-${(new Date).toISOString().replace(/[:.]/g,"-")}.tsv`;return new File([r],a,{type:"text/tab-separated-values"})}catch(e){return k.error("Failed to generate debug logs file",e),null}}const E={dark:{background:o.NeutralGray90,text:o.NeutralGray10,border:o.NeutralGray80,helperText:o.NeutralGray30,link:o.Blue40,error:o.Red40,calloutBg:o.NeutralGray80,calloutBorder:o.NeutralGray60,calloutText:o.NeutralGray20},light:{background:o.White,text:o.NeutralGray90,border:"transparent",helperText:o.NeutralGray40,link:o.Blue60,error:o.Red60,calloutBg:o.NeutralGray10,calloutBorder:o.NeutralGray20,calloutText:o.NeutralGray80},backdropDark:"rgba(0, 0, 0, 0.8)",backdropLight:"rgba(0, 0, 0, 0.5)",shadowDark:"0 8px 16px rgba(0, 0, 0, 0.24)",shadowLight:"0 8px 16px rgba(0, 0, 0, 0.15)"},w=({isOpen:e,onClose:t,onSubmit:r})=>{const[o,p]=a.useState(""),[m,h]=a.useState(""),[b,f]=a.useState([]),[x,y]=a.useState(!1),[k,w]=a.useState(!1),[S,L]=a.useState(null),[B,T]=a.useState(null),F=a.useRef(null),C=a.useRef(null),[N,O]=a.useState((0,g.Y)()),R=(0,d.G)();a.useEffect((()=>{const e=self.matchMedia("(prefers-color-scheme: dark)"),t=()=>O(e.matches);return e.addEventListener("change",t),()=>e.removeEventListener("change",t)}),[]),a.useEffect((()=>{e&&R.trackFormOpen()}),[e,R]),a.useEffect((()=>{e&&C.current&&C.current.focus();const r=e=>{"Escape"===e.key&&t()};return e&&document.addEventListener("keydown",r),()=>{document.removeEventListener("keydown",r)}}),[e,t]);const G=a.useMemo((()=>(e=>{const t=e?E.dark:E.light;return{backdrop:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:e?E.backdropDark:E.backdropLight,display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},dialog:{backgroundColor:t.background,color:t.text,borderRadius:"8px",padding:"20px",maxWidth:"500px",width:"90%",maxHeight:"85%",overflow:"auto",border:e?`1px solid ${t.border}`:"none",boxShadow:e?E.shadowDark:E.shadowLight},helperText:{opacity:.7,color:t.helperText},hiddenFileInput:{display:"none"},ticketLink:{color:t.link,textDecoration:"underline",cursor:"pointer",fontSize:"14px"},errorText:{color:t.error},clickableLabel:{cursor:"pointer"},fileText:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:"8px"},calloutBox:{backgroundColor:t.calloutBg,border:`1px solid ${t.calloutBorder}`,borderRadius:"6px",padding:"10px 12px",margin:"0"},calloutText:{color:t.calloutText,fontSize:"13px",lineHeight:"1.4"},successMessage:{fontSize:"15px",lineHeight:"1.6",color:t.text,fontWeight:500},successLink:{color:t.link,textDecoration:"none",fontSize:"14px",fontWeight:500,display:"inline-block",marginTop:"4px"}}})(N)),[N]);return e?a.createElement("div",{role:"presentation",style:G.backdrop,onMouseDown:e=>{e.target===e.currentTarget&&t()}},a.createElement("div",{ref:C,role:"dialog","aria-modal":"true","aria-labelledby":"bug-report-title",style:G.dialog,tabIndex:-1},B?a.createElement(a.Fragment,null,a.createElement(n.k,{direction:"column",align:"start",gap:3},a.createElement(l.x,{as:"p",style:G.successMessage,id:"bug-report-title"},(()=>{const e=[{bold:"Thanks a ton!",rest:" You just made Superhuman even more super — we'll take it from here."},{bold:"Bug spotted!",rest:" Thanks for helping us squash it — your feedback keeps us flying."},{bold:"Appreciate the catch!",rest:" Every bug report brings us one step closer to perfection."},{bold:"You've got eagle eyes",rest:" — thank you for helping us make things smoother!"},{bold:"Thanks for flagging that!",rest:" We're on it faster than a keyboard shortcut."},{bold:"You found a glitch in the Matrix",rest:" — and we appreciate the heads-up!"},{bold:"Big thanks!",rest:" Your feedback keeps our code (and our team) in top shape."},{bold:"Thanks for the bug report!",rest:" We'll handle it from here — no exterminator required."},{bold:"Got it!",rest:" Thanks for helping us debug our way to brilliance."},{bold:"Appreciate the assist!",rest:" You just made the experience better for everyone."}],t=e[Math.floor(Math.random()*e.length)];return a.createElement(a.Fragment,null,a.createElement("strong",null,t.bold),t.rest)})()),a.createElement(s.x,null,a.createElement("a",{href:B.ticketUrl,target:"_blank",rel:"noopener noreferrer",style:G.successLink},"See your bug report"))),a.createElement(n.k,{gap:2,justify:"end",marginTop:6},a.createElement(i.z,{variant:"primary",text:"Done",onClick:()=>{T(null),t()}}))):a.createElement(a.Fragment,null,a.createElement(c.X,{as:"h2",variant:"heading-medium",marginBottom:2,id:"bug-report-title"},"Report a Bug"),a.createElement(n.k,{direction:"column",gap:3},a.createElement(s.x,null,a.createElement(u.g,{label:"Title",placeholder:"Briefly describe the issue",value:o,onChange:p,rows:1})),a.createElement(s.x,null,a.createElement(u.g,{label:"Description",placeholder:"Provide details about what went wrong and steps to reproduce the issue",value:m,onChange:h})),a.createElement(s.x,null,a.createElement(l.x,{as:"span",variant:"text-small",weight:"medium",color:"base-default"},"Attachment (optional)"),a.createElement(n.k,{direction:"column",gap:2,marginTop:1},a.createElement("input",{ref:F,type:"file",accept:"image/*,video/*",multiple:!0,onChange:e=>{(async e=>{const t=Array.from(e.target.files||[]);if(t.length>0){const r=["image/png","image/jpeg","image/gif","video/mp4","video/mov","video/quicktime","video/avi","video/x-msvideo"],a=t.filter((e=>r.includes(e.type)));if(a.length>0){const e=(await Promise.all(a.map((async e=>{try{const t=await e.arrayBuffer();return new File([t],e.name,{type:e.type})}catch(e){return null}})))).filter((e=>null!==e));e.length>0&&f((t=>[...t,...e]))}e.target.value=""}})(e)},style:G.hiddenFileInput,id:"bug-report-file"}),a.createElement(n.k,{gap:2},a.createElement(i.z,{variant:"secondary",text:"Choose Files",onClick:()=>{var e;return null===(e=F.current)||void 0===e?void 0:e.click()}}),b.length>0&&a.createElement(i.z,{variant:"ghost",text:"Clear All",size:"small",onClick:()=>{f([]),F.current&&(F.current.value="")}})),b.length>0&&a.createElement(n.k,{direction:"column",gap:1},b.map(((e,t)=>a.createElement(n.k,{key:`${e.name}-${t}`,align:"center",gap:2},a.createElement(l.x,{as:"span",variant:"text-small",color:"base-default",style:G.fileText},e.name," (",Math.round(e.size/1024)," KB)"),a.createElement(i.z,{variant:"ghost",text:"Remove",size:"small",onClick:()=>(e=>{f((t=>t.filter(((t,r)=>r!==e))))})(t),style:{flexShrink:0}}))))))),a.createElement(s.x,{style:G.calloutBox},a.createElement(l.x,{as:"span",variant:"text-small",style:G.calloutText},"⚠️ Logs will be auto-collected and may include a portion of your text to help us investigate the issue.")),S&&a.createElement(s.x,null,a.createElement(l.x,{as:"span",variant:"text-small",style:G.errorText},"❌ ",S))),a.createElement(n.k,{gap:2,justify:"end",marginTop:3},a.createElement(i.z,{variant:"secondary",text:"Cancel",onClick:()=>{R.trackFormCancel(),t()},isDisabled:x}),a.createElement(i.z,{variant:"primary",text:k?"Collecting logs...":x?"Submitting...":"Submit",onClick:async()=>{if(o.trim()&&m.trim()){R.trackFormSubmit(),y(!0),w(!0),L(null);try{const e=await v();if(!e)throw new Error("Failed to collect debug logs");w(!1);const t=await r({title:o.trim(),description:m.trim(),attachments:b,debugLogs:e});T(t),L(null),R.trackSuccessPopupShow(),p(""),h(""),f([]),F.current&&(F.current.value="")}catch(e){L(e instanceof Error?e.message:"Failed to submit bug report"),w(!1)}finally{y(!1)}}},isDisabled:!o.trim()||!m.trim()||x}))))):null}},405:(e,t,r)=>{r.d(t,{g:()=>i});var a=r(92379),o=r(45550),n=r(82285),l=r(67283),s=r(42684);const i=a.forwardRef((function(e,t){const{label:r,className:i,helperMessage:c,errorMessage:u,isRequired:g,isOptional:d,placeholder:p,labelDisplay:m="visible",labelIndicatorForOptional:h,labelIndicatorForRequired:b,rows:f=3,resizable:x="on",minLength:y,maxLength:k,spellCheck:v}=e,E=a.useRef(null);a.useImperativeHandle(t,(()=>E.current));const{labelProps:w,inputProps:S}=(0,n.h)({...e,validationState:null!=u?"invalid":"valid",inputElementType:"textarea"},E),L={minLength:y,maxLength:k,spellCheck:v};return a.createElement("div",{className:"gds-text-area"},a.createElement(l.A,{label:r,labelDisplay:m,helperMessage:c,isRequired:g,isOptional:d,labelIndicatorForRequired:b,labelIndicatorForOptional:h,errorMessage:u,...w}),a.createElement("div",{className:"gds-text-area-container"},a.createElement("textarea",{className:(0,o.W)("gds-text-area-input",!0===S.disabled?"":`gds-text-area-resize-${x}`,i),...L,...S,placeholder:p,ref:E,rows:f,style:e.style})),a.createElement(s.f,{errorMessage:u}))}))}}]);