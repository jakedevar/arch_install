(self.webpackChunk=self.webpackChunk||[]).push([[981],{90981:(e,t,n)=>{n.r(t),n.d(t,{activate:()=>m});var s=n(90023),i=n(32073),a=n(59179),r=n(78129),c=n(84308),o=n(84714),d=n(90572),u=n(29416),p=n(63532),l=n(20161),b=n(28338),v=n(39104),h=n(9174),k=n(52493),S=n(90499),A=n(6183),f=n(20473),g=n(25249),w=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),C=e=>{throw TypeError(e)};const m=e=>{return t=void 0,n=[e],m=function*({bus:e,capiCheckingState:t,capiConnectionStatus:n,agentGenericService:m,pushedContentService:y,experimentation:x,document:I,navigation:E,fileUploadService:P,trackingServiceProvider:R}){var K=[];try{const _=((e,t,n)=>{var s;return null!=t?("object"!=typeof t&&"function"!=typeof t&&C("Object expected"),n&&(s=t[w("asyncDispose")]),void 0===s&&(s=t[w("dispose")]),"function"!=typeof s&&C("Object not disposable"),e.push([n,s,t])):n&&e.push([n]),t})(K,new DisposableStack),T=_.adopt(new i.w0,(e=>e.unsubscribe())),j=_.use(e.state.agentState.create(I.id,{kind:h.x.State.Kind.Initial})),D=_.use(e.state.audience.create(I.id,null)),G=_.use(e.state.capiSessionId.create(I.id,null)),z=_.use(e.state.textInfo.create(I.id,{wordsCount:0,charsCount:0})),B=_.use(e.state.hasTextChanges.create(I.id,!1)),M=z.pipe(a.U((e=>e.charsCount)),r.G(),a.U((([e,t])=>t-e))),F=x.isAssigned(A.cV)?c.a([M,E.isPanelOpen],((e,t)=>t&&Math.abs(e)>g.tK)):o.of(!1),L=k.z.create({agentGenericService:m,pushedContentService:y,fileUploadService:P,agentId:S.Qi.Id}),N=_.adopt(h.x.create({title:g.K_,capiSessionId:G.view((e=>null!=e?e:void 0)),agenticService:L,trackingServiceProvider:R,textInfo:z,textChanged:F,featureFlags:{customAudiences:x.isAssigned(A.bI),removeCustomAudiences:x.isAssigned(A.kz)}}),(e=>e.dispose())),Q=n.pipe(a.U((e=>"connected"===e.kind?e:null)),d.h(v.C_));return T.add(N.state.subscribe((e=>j.set(e)))),T.add(N.audience.subscribe((e=>D.set(null!=e?e:null)))),T.add(Q.subscribe((e=>G.set(e.sessionId)))),T.add(t.textInfo.pipe(d.h(v.C_)).subscribe((e=>z.set({wordsCount:e.wordCount,charsCount:e.charCount})))),T.add(N.hasTextChanges.subscribe((e=>B.set(e)))),T.add(e.events.trackingEvent.view(I.id).subscribe((e=>N.context.tracking.trackEvent(e.event,e.detail)))),x.isAssigned(A.l0)&&T.add(y.rebaseItems(f.h).subscribe()),T.add(c.a([z,N.state,E.isPanelOpen],((e,t,n)=>n&&t.kind===h.x.State.Kind.Empty&&e.wordsCount>h.x.MIN_WORDS_TEXT_SIZE)).pipe(d.h(s.yR),u.b(100),d.h((()=>N.state.get().kind===h.x.State.Kind.Empty)),p.b((()=>N.loadReactions()))).subscribe()),T.add(Q.pipe(l.w((e=>c.a([N.state,E.isPanelOpen],((e,t)=>t&&e.kind===h.x.State.Kind.Initial)).pipe(d.h(s.yR),u.b(100),p.b((()=>N.loadReactions())))))).subscribe()),T.add(e.events.panelUIAction.view(I.id).subscribe((e=>{switch(e.kind){case"loadReactionsAction":N.loadReactions();break;case"selectAudienceAction":N.selectAudience();break;case"setAudienceAction":N.setAudience(e.audience);break;case"editAudienceAction":N.editAudience();break;case"saveAudienceAction":N.saveAudience(e.name);break;case"removeAudienceAction":N.removeAudience(e.audience);break;case"goBackAction":N.goBack();break;default:(0,b.L0)(e)}}))),_.move()}catch(e){var O=e,U=!0}finally{((e,t,n)=>{var s="function"==typeof SuppressedError?SuppressedError:function(e,t,n,s){return(s=Error(n)).name="SuppressedError",s.error=e,s.suppressed=t,s},i=e=>t=n?new s(e,t,"An error was suppressed during disposal"):(n=!0,e),a=s=>{for(;s=e.pop();)try{var r=s[1]&&s[1].call(s[2]);if(s[0])return Promise.resolve(r).then(a,(e=>(i(e),a())))}catch(e){i(e)}if(n)throw t};a()})(K,O,U)}},new Promise(((e,s)=>{var i=e=>{try{r(m.next(e))}catch(e){s(e)}},a=e=>{try{r(m.throw(e))}catch(e){s(e)}},r=t=>t.done?e(t.value):Promise.resolve(t.value).then(i,a);r((m=m.apply(t,n)).next())}));var t,n,m}}}]);