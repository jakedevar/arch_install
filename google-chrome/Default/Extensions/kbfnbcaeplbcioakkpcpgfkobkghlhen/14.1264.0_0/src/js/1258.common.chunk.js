(self.webpackChunk=self.webpackChunk||[]).push([[1258],{1258:(e,s,t)=>{t.r(s),t.d(s,{activate:()=>E});var n=t(32073),r=t(84714),o=t(90572),i=t(28338),a=t(90023),c=t(58303),u=t(72847),p=t(94064),d=t(12518),l=t(88012),b=t(18519),v=t(66878),h=t(36344);class g{constructor(e){this._agentGenericService=e,this._subs=new l.w.Keeper,this._lastPendingRequests=new Map}cancelLastPendingRequest(e){const s=this._lastPendingRequests.get(e);void 0!==s&&(s.unsubscribe(),this._lastPendingRequests.delete(e))}runRequest(e,s,t,n){return this._agentGenericService.requestWithStreaming({agentId:p.Gq,commandId:e,payload:s})().then((e=>(0,a.zG)(e,d.pF((e=>{throw e}))))).then((s=>new Promise(((r,o)=>{const i=(0,a.zG)(t,c.g_((()=>s),(e=>s.pipe(b.V(e),v.K((e=>(b.W,o(e),h.E))))))).subscribe((e=>{(0,a.zG)(e,d.KB((e=>{o(e)}),(e=>{n(e),"final"===e.kind&&r()})))}));this._subs.push(i),this._lastPendingRequests.set(e,i)}))))}dispose(){this._subs.dispose()}}var f=t(30349),w=t(11546),y=t(6183),k=(e,s)=>(s=Symbol[e])?s:Symbol.for("Symbol."+e),x=e=>{throw TypeError(e)},m=(e,s,t)=>new Promise(((n,r)=>{var o=e=>{try{a(t.next(e))}catch(e){r(e)}},i=e=>{try{a(t.throw(e))}catch(e){r(e)}},a=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,i);a((t=t.apply(e,s)).next())}));const E=e=>m(void 0,[e],(function*({bus:e,document:s,agentGenericService:t,pushedContentService:d,capiEvents:l,capiCheckingState:b,capiConnectionStatus:v,experimentation:h,navigation:E,trackingServiceProvider:S}){var A=[];try{const P=((e,s,t)=>{var n;return null!=s?("object"!=typeof s&&"function"!=typeof s&&x("Object expected"),t&&(n=s[k("asyncDispose")]),void 0===n&&(n=s[k("dispose")]),"function"!=typeof n&&x("Object not disposable"),e.push([t,n,s])):t&&e.push([t]),s})(A,new DisposableStack),U=P.adopt(new n.w0,(e=>e.unsubscribe())),R=P.use(e.state.agentState.create(s.id,w.b6)),q=P.use(e.state.followUpTopics.create(s.id,[])),_=P.use(e.state.capiSessionId.create(s.id,null)),B=P.use(e.state.textInfo.create(s.id,{wordsCount:0,charsCount:0})),T=new g(t),F=P.adopt(new p.XC(d,{events:l},v.view((e=>"connected"===e.kind)),S,T,B,{setFocusMode:a.Q1,focusModeDecorationType:r.of(c.YP),removeAgentDecorations:a.Q1},f.p,{followUpActions:h.isAssigned(y.ob),followUpActionsFreeformInput:h.isAssigned(y.sq),shouldAutoScrollToFirstVBar:h.isAssigned(y.aR),usePushedContentRebasing:h.isAssigned(y.yK)},E.isPanelOpen,E.isPanelOpen),(e=>e[Symbol.dispose]()));return U.add(F.state.subscribe((e=>R.set(e)))),U.add(F.followUpTopics.subscribe((e=>{q.set(e)}))),U.add(l.pipe(o.h(u.hX.is("session_started"))).subscribe((e=>_.set(e.sessionUuid)))),U.add(b.textInfo.subscribe((e=>(0,a.zG)(c.ij(e),c.UI((e=>({wordsCount:e.wordCount,charsCount:e.charCount}))),c.fS((()=>({wordsCount:0,charsCount:0}))),B.set)))),U.add(e.events.trackingEvent.view(s.id).subscribe((e=>F.context.tracking.trackEvent(e.event,e.detail)))),U.add(e.events.panelUIAction.view(s.id).subscribe((t=>m(void 0,null,(function*(){switch(t.kind){case"selectExpert":F.internalActions.selectExpert(t.expertName);break;case"deselectExpert":F.internalActions.deselectExpert();break;case"removeExpert":F.internalActions.removeExpert(t.expertName);break;case"goToChooseExperts":F.internalActions.goToChooseExperts();break;case"goBackFromChooseExperts":F.internalActions.goBackFromChooseExperts();break;case"reloadAgent":F.internalActions.reloadAgent();break;case"addExpertsByTopic":yield F.internalActions.addExpertsByTopic(t.topic),e.events.panelUIResponse.emit(s.id,{kind:"addExpertsByTopicResponse",topic:t.topic});break;case"addExpertsByUserInput":yield F.internalActions.addExpertsByUserInput(t.userInput),e.events.panelUIResponse.emit(s.id,{kind:"addExpertsByUserInputResponse",userInput:t.userInput});break;case"requestFollowUpSuggestions":F.internalActions.requestFollowUpSuggestions();break;default:(0,i.L0)(t)}}))))),P.move()}catch(e){var C=e,I=!0}finally{((e,s,t)=>{var n="function"==typeof SuppressedError?SuppressedError:function(e,s,t,n){return(n=Error(t)).name="SuppressedError",n.error=e,n.suppressed=s,n},r=e=>s=t?new n(e,s,"An error was suppressed during disposal"):(t=!0,e),o=n=>{for(;n=e.pop();)try{var i=n[1]&&n[1].call(n[2]);if(n[0])return Promise.resolve(i).then(o,(e=>(r(e),o())))}catch(e){r(e)}if(t)throw s};o()})(A,C,I)}}))},66878:(e,s,t)=>{t.d(s,{K:()=>i});var n=t(16537),r=t(96643),o=t(19064);function i(e){return(0,o.e)((function(s,t){var o,a=null,c=!1;a=s.subscribe((0,r.x)(t,void 0,void 0,(function(r){o=(0,n.Xf)(e(r,i(e)(s))),a?(a.unsubscribe(),a=null,o.subscribe(t)):c=!0}))),c&&(a.unsubscribe(),a=null,o.subscribe(t))}))}}}]);